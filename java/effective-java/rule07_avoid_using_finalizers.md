# Avoid using finalizers
종료자를 사용한다는 것은 `finalize()`함수를 **_재정의(override)_**하는 것을 의미한다.
### `finalize()`란?
- 객체에 대한 참조가 존재하지 않을 때 garbage collector가 호출하는 메소드이다.

## `finalize()`를 사용하지 말아야 하는 이유
- 언제 호출 될 지 알 수 없다.
	- 자바 스펙에는 종료자가 객체에 대한 참조가 사라지는 즉시 실행되어야 한다고 명세하고 있지 않다.
- 호출을 장담할 수 없다.
	- 자바 스펙에는 종료자가 객체에 대한 참조가 사라지면 반드시 실행돼야 한다고 명세하고 있지 않다.
- 종료자의 호출은 JVM 구현에 따라 상이하다.

## 그래도 굳이 사용하고 싶다면
### 종료 메소드 호출을 잊을 경우를 대비한 안전망으로 사용
- Garbage collector가 관리하지 않는 자원을 사용하는 경우 명시적으로 자원을 반환하는 종료 메소드가 필요하다.
- 사용자가 종료 메소드를 호출하지 않을 경우를 대비하여 `finalize()`를 override 하여 자원을 반환하는 안전망을 구축할 수 있다.
	- 반드시 **_log_**를 남기도록 해야 한다.
	- 종료 메소드를 호출하는 것이 훠얼씬 좋은 방법이기 때문에 사용자에게 알려야 하기 때문이다.

### `finalize()` 사용 시 주의 사항
#### 종료자를 사용하는 클래스를 상속하여 다시 종료자를 override 하는 경우
- 반드시 `super.finalize()`를 호출해야 한다.
- 예외가 발생해도 호출되도록 `finally` 블록안에서 호출 한다.
- 상위 클래스의 `finalize()`는 절대 자동으로 호출 되지 않는다.
	- 하위 클래스가 재정의(덮어 씀)했기 때문에 실행되지 않는 것.
- 상위 클래스를 만들 때 Finalizer quardian pattern 사용을 고려하라.
	- 하위 클래스에서 상위 클래스의 종료자를 실행하지 않는 것에 대비한 패턴
	- 상위 클래스에서 종료자를 재정의하는 대신 익명 클래스를 멤버로 갖고 익명 클래스에서 종료자를 사용
	- 상위 클래스에 대한 모든 참조가 사라지는 순간 종료 보호자의 종료자가 실행
```java
public class Foo {
	private final Object finalizerGuadian = new Object() {
		@Override
		protected void finalize() throws Throwable {
			// Foo 객체를 종료시키는 로직
		}
	}
}
```
